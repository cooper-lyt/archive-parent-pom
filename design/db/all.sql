SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE IF EXISTS user_role;
DROP TABLE IF EXISTS role;
DROP TABLE IF EXISTS _user;




/* Create Tables */

CREATE TABLE role
(
    authority varchar(32) NOT NULL,
    name varchar(32) NOT NULL,
    PRIMARY KEY (authority)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE user_role
(
    username varchar(32) NOT NULL,
    authority varchar(32) NOT NULL
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE _user
(
    username varchar(32) NOT NULL,
    password varchar(512) NOT NULL,
    name varchar(64) NOT NULL,
    enabled boolean NOT NULL,
    org varchar(32),
    orgname varchar(128),
    PRIMARY KEY (username)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;



/* Create Foreign Keys */

ALTER TABLE user_role
    ADD FOREIGN KEY (authority)
        REFERENCES role (authority)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE user_role
    ADD FOREIGN KEY (username)
        REFERENCES _user (username)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


insert into role(authority, name) VALUES ('GOV','政府机构');

insert into role(authority, name) VALUES ('CORP','从业机构');

insert into role(authority,name) VALUES('ADMIN','管理员');

insert into role(authority, name) VALUES ('ARCHIVE','档案员');



-- pasword: dgsoft
insert into _user(username,password,name,enabled) VALUES ('root','$2a$10$CmODDYEHEYJYWDsxu9ZzfumnUhiFFViGwq9Fmx12tBjmB/TSzGmBu','开发商管理员', true);


insert into _user(username,password,name,enabled,org,orgname)
VALUES('corp1','$2a$10$CmODDYEHEYJYWDsxu9ZzfumnUhiFFViGwq9Fmx12tBjmB/TSzGmBu','机构档案员',true,'C1','测试建设单位1');

insert into user_role(authority,username) VALUES ('GOV','root');
insert into user_role(authority,username) VALUES ('ARCHIVE','root');
insert into user_role(authority,username) VALUES ('ADMIN','root');

insert into user_role(authority,username) VALUES ('CORP','corp1');
insert into user_role(authority,username) VALUES ('ARCHIVE','corp1');
insert into user_role(authority,username) VALUES ('ADMIN','corp1');


SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE IF EXISTS FIELD_VALUE;
DROP TABLE IF EXISTS BUSINESS_FIELD_GROUP;
DROP TABLE IF EXISTS OPERATION;
DROP TABLE IF EXISTS VOL_CONETXT;
DROP TABLE IF EXISTS VOL_ITEM;
DROP TABLE IF EXISTS VOLUME;
DROP TABLE IF EXISTS RECORD_BUSINESS;




/* Create Tables */

CREATE TABLE BUSINESS_FIELD_GROUP
(
    FIELD_ID varchar(32) NOT NULL,
    BUSINESS_ID varchar(24) NOT NULL,
    NAME varchar(16) NOT NULL,
    TYPE varchar(32) NOT NULL,
    _ORDINAL int NOT NULL,
    _OPTION text,
    _ROW int NOT NULL,
    DEFINE varchar(32),
    PRIMARY KEY (FIELD_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE FIELD_VALUE
(
    VALUE_ID bigint NOT NULL AUTO_INCREMENT,
    _PATTERN varchar(32),
    _VALUE text,
    FIELD_ID varchar(32) NOT NULL,
    _ORDINAL int NOT NULL,
    LABEL varchar(32),
    _OPTION text,
    PRIMARY KEY (VALUE_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE OPERATION
(
    OPERATION_ID bigint NOT NULL AUTO_INCREMENT,
    BUSINESS_ID varchar(24) NOT NULL,
    TYPE varchar(8) NOT NULL,
    EMP_ID varchar(32) NOT NULL,
    EMP_NAME varchar(50) NOT NULL,
    _EXPLAIN varchar(256),
    OPERATION_TIME datetime NOT NULL,
    PRIMARY KEY (OPERATION_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE RECORD_BUSINESS
(
    BUSINESS_ID varchar(24) NOT NULL,
    DEFINE_ID varchar(32),
    DEFINE_NAME varchar(16) NOT NULL,
    DEFINE_VER int NOT NULL,
    DELIVER_TYPE varchar(16),
    DELIVER varchar(32) NOT NULL,
    DELIVER_ID varchar(32),
    RECEIVE_DATE date NOT NULL,
    MEMO varchar(256),
    _KEY varchar(512),
    STATUS varchar(8) NOT NULL,
    _VERSION int NOT NULL,
    SUMMARY varchar(1024) NOT NULL,
    _SOURCE varchar(8) NOT NULL,
    SEQ bigint NOT NULL,
    CHANGE_TIME datetime NOT NULL,
    SUMMARY_TEMPLATE varchar(1024),
    PROJECT_NAME varchar(128) NOT NULL,
    PROJECT_ID varchar(32),
    PRIMARY KEY (BUSINESS_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE VOLUME
(
    VOLUME_ID varchar(32) NOT NULL,
    BUSINESS_ID varchar(24) NOT NULL,
    BOX_ID varchar(32),
    PAGE_COUNT int,
    RECORD_TIME date NOT NULL,
    SECRECY_LEVEL varchar(10) NOT NULL,
    SECRECY_LEN int,
    OLD boolean NOT NULL,
    MEMO varchar(256),
    PRIMARY KEY (VOLUME_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE VOL_CONETXT
(
    CONTEXT_ID varchar(32) NOT NULL,
    TYPE varchar(32) NOT NULL,
    ORDINAL int NOT NULL,
    PAGE_COUNT int NOT NULL,
    MD5 varchar(32),
    ITEM_ID bigint NOT NULL,
    PRIMARY KEY (CONTEXT_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE VOL_ITEM
(
    ITEM_ID bigint NOT NULL AUTO_INCREMENT,
    BUSINESS_ID varchar(24) NOT NULL,
    NAME varchar(256) NOT NULL,
    TYPE varchar(4) NOT NULL,
    EL varchar(32),
    DESCRIPTION varchar(512),
    SEQ int NOT NULL,
    PRIMARY KEY (ITEM_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;



/* Create Foreign Keys */

ALTER TABLE FIELD_VALUE
    ADD FOREIGN KEY (FIELD_ID)
        REFERENCES BUSINESS_FIELD_GROUP (FIELD_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE VOL_ITEM
    ADD FOREIGN KEY (BUSINESS_ID)
        REFERENCES RECORD_BUSINESS (BUSINESS_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE VOLUME
    ADD FOREIGN KEY (BUSINESS_ID)
        REFERENCES RECORD_BUSINESS (BUSINESS_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE OPERATION
    ADD FOREIGN KEY (BUSINESS_ID)
        REFERENCES RECORD_BUSINESS (BUSINESS_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE BUSINESS_FIELD_GROUP
    ADD FOREIGN KEY (BUSINESS_ID)
        REFERENCES RECORD_BUSINESS (BUSINESS_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE VOL_CONETXT
    ADD FOREIGN KEY (ITEM_ID)
        REFERENCES VOL_ITEM (ITEM_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;



SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE IF EXISTS TASK_ACTION;
DROP TABLE IF EXISTS FIELD_DEFINE;
DROP TABLE IF EXISTS FIELD_GROUP;
DROP TABLE IF EXISTS CREATE_ROLE;
DROP TABLE IF EXISTS VOL_ITEM_DEFINE;
DROP TABLE IF EXISTS CROP_BUSINESS;
DROP TABLE IF EXISTS BUSINESS_DEFINE;
DROP TABLE IF EXISTS BUSINESS_CATEGORY;




/* Create Tables */

CREATE TABLE BUSINESS_CATEGORY
(
    CATEGORY_ID varchar(4) NOT NULL,
    NAME varchar(50) NOT NULL,
    PRIORITY int NOT NULL,
    PRIMARY KEY (CATEGORY_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE BUSINESS_DEFINE
(
    DEFINE_ID varchar(8) NOT NULL,
    NAME varchar(64) NOT NULL,
    WF_NAME varchar(32),
    START_PAGE varchar(256),
    CATEGORY_ID varchar(4) NOT NULL,
    MEMO varchar(512),
    -- 乐观锁
    _VERSION int,
    ROLE_PREFIX varchar(16),
    -- 动态
    DESCRIPTION varchar(512),
    PRIORITY int NOT NULL,
    ENABLE boolean NOT NULL,
    WF_VER int NOT NULL,
    CREATE_TITLE varchar(8),
    CREATE_COMPLETE_PAGE varchar(256),
    DEFAULT_ROOM varchar(4),
    DEFAULT_RACK varchar(8),
    DEFAULT_SECRECY_LEVEL varchar(10),
    SUMMARY varchar(1024) NOT NULL,
    DEFAULT_SECRECY_LEN int,
    CONSTRAINT PK_DGBIZ PRIMARY KEY (DEFINE_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE CREATE_ROLE
(
    ROLE varchar(32) NOT NULL,
    DEFINE_ID varchar(8) NOT NULL,
    ID int NOT NULL AUTO_INCREMENT,
    PRIMARY KEY (ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE CROP_BUSINESS
(
    ID bigint NOT NULL AUTO_INCREMENT,
    DEFINE_ID varchar(8) NOT NULL,
    CORP_TYPE varchar(16) NOT NULL,
    PRIMARY KEY (ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE FIELD_DEFINE
(
    VALUE_ID bigint NOT NULL AUTO_INCREMENT,
    GROUP_ID varchar(32) NOT NULL,
    _ORDINAL int NOT NULL,
    _OPTION text,
    PRIMARY KEY (VALUE_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE FIELD_GROUP
(
    GROUP_ID varchar(32) NOT NULL,
    NAME varchar(16) NOT NULL,
    TYPE varchar(32) NOT NULL,
    EDITOR_ORDINAL int NOT NULL,
    DISPLAY_ORDINAL int NOT NULL,
    DEFINE_ID varchar(8) NOT NULL,
    VIEW_ROW int NOT NULL,
    _OPTION text,
    PRIMARY KEY (GROUP_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE TASK_ACTION
(
    DEFINE_ID varchar(8) NOT NULL,
    TASK_NAME varchar(128),
    TYPE varchar(32) NOT NULL,
    REG_NAME varchar(32) NOT NULL,
    PRIORITY int NOT NULL,
    ACTION_ID bigint NOT NULL,
    _POSITION varchar(8) NOT NULL,
    PRIMARY KEY (ACTION_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE VOL_ITEM_DEFINE
(
    ITEM_ID bigint NOT NULL AUTO_INCREMENT,
    NAME varchar(200) NOT NULL,
    TYPE varchar(4) NOT NULL,
    EL varchar(32),
    DESCRIPTION varchar(512),
    DEFINE_ID varchar(8) NOT NULL,
    SEQ int NOT NULL,
    PRIMARY KEY (ITEM_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;



/* Create Foreign Keys */

ALTER TABLE BUSINESS_DEFINE
    ADD FOREIGN KEY (CATEGORY_ID)
        REFERENCES BUSINESS_CATEGORY (CATEGORY_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE TASK_ACTION
    ADD FOREIGN KEY (DEFINE_ID)
        REFERENCES BUSINESS_DEFINE (DEFINE_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE FIELD_GROUP
    ADD FOREIGN KEY (DEFINE_ID)
        REFERENCES BUSINESS_DEFINE (DEFINE_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE CREATE_ROLE
    ADD FOREIGN KEY (DEFINE_ID)
        REFERENCES BUSINESS_DEFINE (DEFINE_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE VOL_ITEM_DEFINE
    ADD FOREIGN KEY (DEFINE_ID)
        REFERENCES BUSINESS_DEFINE (DEFINE_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE CROP_BUSINESS
    ADD FOREIGN KEY (DEFINE_ID)
        REFERENCES BUSINESS_DEFINE (DEFINE_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE FIELD_DEFINE
    ADD FOREIGN KEY (GROUP_ID)
        REFERENCES FIELD_GROUP (GROUP_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;



INSERT INTO BUSINESS_CATEGORY(CATEGORY_ID, NAME, PRIORITY) VALUES ('I','测试业务',1);
INSERT INTO BUSINESS_DEFINE(DEFINE_ID, NAME, CATEGORY_ID, _VERSION, PRIORITY, ENABLE, WF_VER,SUMMARY) VALUES('I1','测试业务1','I',1,1,true,1,'送交单位{.deliver}');
INSERT INTO BUSINESS_DEFINE(DEFINE_ID, NAME, CATEGORY_ID, _VERSION, PRIORITY, ENABLE, WF_VER,SUMMARY,DEFAULT_ROOM, DEFAULT_RACK, DEFAULT_SECRECY_LEN, DEFAULT_SECRECY_LEVEL)
VALUES('I2','测试业务2','I',1,1,true,1,'送交单位{.deliver},建设单位{I2-3.2}','A','A-1',10,'TopSecret');

INSERT INTO VOL_ITEM_DEFINE(NAME, TYPE, DESCRIPTION, DEFINE_ID, SEQ) VALUES('测试要件','NEED', '要件描述', 'I2',10000);
INSERT INTO VOL_ITEM_DEFINE(NAME, TYPE, DESCRIPTION, DEFINE_ID, SEQ) VALUES('测试附件','NEED', '附件描述', 'I2',20000);

INSERT INTO CREATE_ROLE(ROLE, DEFINE_ID) VALUES ('GOV','I1');
INSERT INTO CREATE_ROLE(ROLE, DEFINE_ID) VALUES ('GOV','I2');

INSERT INTO FIELD_GROUP(GROUP_ID, NAME, TYPE, EDITOR_ORDINAL, DISPLAY_ORDINAL, DEFINE_ID,VIEW_ROW)
VALUES ('I2-1','测试字符','SIMPLE',1,1,'I2',0);

INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL, _OPTION)
VALUES ('I2-1',0,'{"style": "col-lg-4 col-md-12","nullable":true,"key":true,"minLength":3, "maxLength":5 ,"label":"测试字符串","controlType":"textbox","editPattern":"[3-8]{1}[0-9]{3}"}');
INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL, _OPTION)
VALUES ('I2-1',1,'{"style": "col-lg-4 col-md-12","nullable":false,"key":false,"label":"测试金额","controlType":"textbox","type":"number","min":10, "max":100 ,"autocomplete":"off"}');
INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL,_OPTION)
VALUES ('I2-1',2,'{"style": "col-lg-4 col-md-12","nullable":false,"key":true,"label":"测试选择","controlType":"dropdown","option":["第一个","第二个"]}');


INSERT INTO FIELD_GROUP(GROUP_ID,NAME,TYPE,EDITOR_ORDINAL,DISPLAY_ORDINAL,DEFINE_ID,VIEW_ROW,_OPTION)
VALUES('I2-3','测试单位','CONSTRUCT_CORP',2,2,'I2',1,'{"nullable":false,"key":true}');


INSERT INTO FIELD_GROUP(GROUP_ID,NAME,TYPE,EDITOR_ORDINAL,DISPLAY_ORDINAL,DEFINE_ID,VIEW_ROW)
VALUES('I2-4','测试日期','SIMPLE',3,3,'I2',2);

INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL, _OPTION)
VALUES ('I2-4',0,'{"style": "col-lg-4 col-md-12","nullable":false,"key":false,"label":"测试日期","controlType":"datepicker"}');

INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL, _OPTION)
VALUES ('I2-4',1,'{"style": "col-lg-4 col-md-12","nullable":false,"key":false,"label":"测试时间","istime":true,"controlType":"datepicker"}');

INSERT INTO FIELD_GROUP(GROUP_ID,NAME,TYPE,EDITOR_ORDINAL,DISPLAY_ORDINAL,DEFINE_ID,VIEW_ROW,_OPTION)
VALUES('I2-5','测试多行输入','TEXT_AREA',4,4,'I2',4,'{"key":true,"nullable":true,"rows":4}');

INSERT INTO FIELD_DEFINE(GROUP_ID, _ORDINAL)
VALUES ('I2-5',0);



INSERT INTO CROP_BUSINESS(DEFINE_ID, CORP_TYPE) VALUES ('I2','BUILD');


SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE IF EXISTS CONSTRUCT_CORP;
DROP TABLE IF EXISTS RIGHT_PROJECT_JOIN_TYPE;
DROP TABLE IF EXISTS RIGHT_CORP_TYPE;
DROP TABLE IF EXISTS PERSON_RIGHT;
DROP TABLE IF EXISTS CORP;
DROP TABLE IF EXISTS PERSON;




/* Create Tables */

CREATE TABLE CONSTRUCT_CORP
(
    REG_ID varchar(32) NOT NULL,
    CORP_TYPE varchar(16) NOT NULL,
    REG_DATE date NOT NULL,
    REG_DATE_TO date,
    _LEVEL varchar(8),
    LEVEL_NUMBER varchar(32),
    STATUS varchar(16) NOT NULL,
    CORP_ID varchar(32) NOT NULL,
    PRIMARY KEY (REG_ID),
    CONSTRAINT CORP_TYPE_UNIQUE UNIQUE (CORP_TYPE, CORP_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE CORP
(
    CORP_ID varchar(32) NOT NULL,
    NAME varchar(128) NOT NULL,
    REG_ID_TYPE varchar(16) NOT NULL,
    REG_ID_NUMBER varchar(32) NOT NULL,
    OWNER_NAME varchar(64) NOT NULL,
    OWNER_ID_TYPE varchar(16) NOT NULL,
    OWNER_ID_NUMBER varchar(32) NOT NULL,
    ADDRESS varchar(256),
    TEL varchar(16),
    _VERSION bigint NOT NULL,
    DESCRIPTION varchar(256),
    PRIMARY KEY (CORP_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE PERSON
(
    PERSON_ID varchar(32) NOT NULL,
    NAME varchar(64) NOT NULL,
    IDENTIFY_TYPE varchar(16) NOT NULL,
    IDENTIFY_NUMBER varchar(32) NOT NULL,
    TEL varchar(16),
    SEX varchar(6),
    BIRTH_DATE date,
    NATION varchar(16),
    NATIONALITY varchar(16),
    ADDRESS varchar(256),
    REG_ADDRESS varchar(16),
    TITLE varchar(8),
    PRIMARY KEY (PERSON_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE PERSON_RIGHT
(
    RIGHT_ID varchar(32) NOT NULL,
    NAME varchar(32) NOT NULL,
    ENABLE boolean NOT NULL,
    PRI int NOT NULL,
    CORP_ID varchar(32) NOT NULL,
    STATUS varchar(16) NOT NULL,
    PERSON_ID varchar(32) NOT NULL,
    _VERSION bigint NOT NULL,
    _LEVEL varchar(8) NOT NULL,
    PRIMARY KEY (RIGHT_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE RIGHT_CORP_TYPE
(
    CORP_TYPE varchar(16) NOT NULL,
    TYPE varchar(32) NOT NULL,
    PRIMARY KEY (CORP_TYPE, TYPE)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE RIGHT_PROJECT_JOIN_TYPE
(
    JOIN_TYPE varchar(16) NOT NULL,
    CORP_TYPE varchar(32) NOT NULL,
    PRIMARY KEY (JOIN_TYPE, CORP_TYPE)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;



/* Create Foreign Keys */

ALTER TABLE CONSTRUCT_CORP
    ADD FOREIGN KEY (CORP_ID)
        REFERENCES CORP (CORP_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE PERSON_RIGHT
    ADD FOREIGN KEY (CORP_ID)
        REFERENCES CORP (CORP_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE PERSON_RIGHT
    ADD FOREIGN KEY (PERSON_ID)
        REFERENCES PERSON (PERSON_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE RIGHT_PROJECT_JOIN_TYPE
    ADD FOREIGN KEY (CORP_TYPE)
        REFERENCES PERSON_RIGHT (RIGHT_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE RIGHT_CORP_TYPE
    ADD FOREIGN KEY (TYPE)
        REFERENCES PERSON_RIGHT (RIGHT_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


INSERT INTO CORP(CORP_ID, NAME, REG_ID_TYPE, REG_ID_NUMBER, OWNER_NAME, OWNER_ID_TYPE, OWNER_ID_NUMBER, ADDRESS, TEL, _VERSION)
VALUES ('C1','测试建设单位1','OTHER','000','法人','OTHER','0001','地址','010',1);

INSERT INTO CONSTRUCT_CORP(REG_ID, CORP_TYPE, REG_DATE, STATUS, CORP_ID)
VALUES('A1','CONSTRUCTION','2019-1-1' , 'NO','C1' );

INSERT INTO CORP(CORP_ID, NAME, REG_ID_TYPE, REG_ID_NUMBER, OWNER_NAME, OWNER_ID_TYPE, OWNER_ID_NUMBER, ADDRESS, TEL, _VERSION)
VALUES ('C3','测试建设单位2','OTHER','000','法人','OTHER','0001','地址','010',1);

INSERT INTO CONSTRUCT_CORP(REG_ID, CORP_TYPE, REG_DATE, STATUS, CORP_ID)
VALUES('A3','CONSTRUCTION','2019-1-1' , 'NO','C3' );

INSERT INTO CORP(CORP_ID, NAME, REG_ID_TYPE, REG_ID_NUMBER, OWNER_NAME, OWNER_ID_TYPE, OWNER_ID_NUMBER, ADDRESS, TEL, _VERSION)
VALUES ('C4','测试建设单位3','OTHER','000','法人','OTHER','0001','地址','010',1);

INSERT INTO CONSTRUCT_CORP(REG_ID, CORP_TYPE, REG_DATE, STATUS, CORP_ID)
VALUES('A4','CONSTRUCTION','2019-1-1' , 'NO','C4' );

INSERT INTO CORP(CORP_ID, NAME, REG_ID_TYPE, REG_ID_NUMBER, OWNER_NAME, OWNER_ID_TYPE, OWNER_ID_NUMBER, ADDRESS, TEL, _VERSION)
VALUES ('C2','测试施工单位','OTHER','000','法人','OTHER','0001','地址','010',1);

INSERT INTO CONSTRUCT_CORP(REG_ID, CORP_TYPE, REG_DATE, STATUS, CORP_ID)
VALUES('A2','BUILD','2019-1-1' , 'NO','C2' );


SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE IF EXISTS BOX;
DROP TABLE IF EXISTS CELL;
DROP TABLE IF EXISTS CABINET;
DROP TABLE IF EXISTS RACK;
DROP TABLE IF EXISTS ROOM;




/* Create Tables */

CREATE TABLE BOX
(
    BOX_ID varchar(32) NOT NULL,
    _FULL boolean NOT NULL,
    EMPTY boolean NOT NULL,
    _SIZE int NOT NULL,
    SEQ int NOT NULL,
    DESCRIPTION varchar(256),
    CELL_ID varchar(24) NOT NULL,
    OLD boolean NOT NULL,
    PRIMARY KEY (BOX_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE CABINET
(
    CABINET_ID varchar(16) NOT NULL,
    NAME varchar(8) NOT NULL,
    RACK_ID varchar(8) NOT NULL,
    SEQ int NOT NULL,
    PERCENTAGE int NOT NULL,
    PRIMARY KEY (CABINET_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE CELL
(
    CELL_ID varchar(24) NOT NULL,
    NAME varchar(8) NOT NULL,
    CABINET_ID varchar(16) NOT NULL,
    _SIZE int,
    SEQ int NOT NULL,
    _ROW int NOT NULL,
    _COL int NOT NULL,
    PERCENTAGE int NOT NULL,
    PRIMARY KEY (CELL_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE RACK
(
    RACK_ID varchar(8) NOT NULL,
    NAME varchar(4) NOT NULL,
    ROOM_ID varchar(4) NOT NULL,
    PERCENTAGE int NOT NULL,
    SEQ int NOT NULL,
    PRIMARY KEY (RACK_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;


CREATE TABLE ROOM
(
    ROOM_ID varchar(4) NOT NULL,
    NAME varchar(16) NOT NULL,
    DESCRIPTION varchar(256),
    PERCENTAGE int NOT NULL,
    SEQ int NOT NULL,
    PRIMARY KEY (ROOM_ID)
) ENGINE = InnoDB DEFAULT CHARACTER SET utf8;



/* Create Foreign Keys */

ALTER TABLE CELL
    ADD FOREIGN KEY (CABINET_ID)
        REFERENCES CABINET (CABINET_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE BOX
    ADD FOREIGN KEY (CELL_ID)
        REFERENCES CELL (CELL_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE CABINET
    ADD FOREIGN KEY (RACK_ID)
        REFERENCES RACK (RACK_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;


ALTER TABLE RACK
    ADD FOREIGN KEY (ROOM_ID)
        REFERENCES ROOM (ROOM_ID)
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
;

/* INSERT TEST DATA */

INSERT INTO ROOM(ROOM_ID,NAME,PERCENTAGE,SEQ) VALUES('A','一号档案室',10,1);
INSERT INTO ROOM(ROOM_ID,NAME,PERCENTAGE,SEQ) VALUES('B','二号档案室',0,2);
INSERT INTO ROOM(ROOM_ID,NAME,PERCENTAGE,SEQ) VALUES('C','三号档案室',0,3);
INSERT INTO ROOM(ROOM_ID,NAME,PERCENTAGE,SEQ) VALUES('D','四号档案室',0,4);

INSERT INTO RACK(RACK_ID,NAME,ROOM_ID,PERCENTAGE,SEQ) VALUES('A-1','1','A',10,1);
INSERT INTO RACK(RACK_ID,NAME,ROOM_ID,PERCENTAGE,SEQ) VALUES('A-2','2','A',0,2);

INSERT INTO RACK(RACK_ID,NAME,ROOM_ID,PERCENTAGE,SEQ) VALUES('B-1','1','B',0,1);
INSERT INTO RACK(RACK_ID,NAME,ROOM_ID,PERCENTAGE,SEQ) VALUES('B-2','2','B',0,2);

INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-1B','1B','A-1',1,10);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-2A','2A','A-1',2,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-2B','2B','A-1',3,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-3A','3A','A-1',4,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-3B','3B','A-1',5,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-4A','4A','A-1',6,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-4B','4B','A-1',7,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-5A','5A','A-1',8,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-5B','5B','A-1',9,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-6A','6A','A-1',10,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-6B','6B','A-1',11,0);
INSERT INTO CABINET(CABINET_ID,NAME,RACK_ID,SEQ,PERCENTAGE) VALUES('A-1-7A','7A','A-1',12,0);

INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-1-1','1-1','A-1-1B',10,1,1,1,100);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-1-2','1-2','A-1-1B',10,2,1,2,50);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-1-3','1-3','A-1-1B',10,3,1,3,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-1-4','1-4','A-1-1B',10,4,1,4,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-2-1','2-1','A-1-1B',10,5,2,1,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-2-2','2-2','A-1-1B',10,6,2,2,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-2-3','2-3','A-1-1B',10,7,2,3,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-2-4','2-4','A-1-1B',10,8,2,4,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-3-1','3-1','A-1-1B',10,9,3,1,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-3-2','3-2','A-1-1B',10,10,3,2,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-3-3','3-3','A-1-1B',10,11,3,3,0);
INSERT INTO CELL(CELL_ID,NAME,CABINET_ID,_SIZE,SEQ,_ROW,_COL,PERCENTAGE) VALUES('A-1-1B-3-4','3-4','A-1-1B',10,12,3,4,0);


INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-1',true,false,1,1,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-2',true,false,1,2,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-3',true,false,1,3,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-4',true,false,2,4,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-5',true,false,1,5,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-6',true,false,2,6,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-7',true,false,1,7,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-1-8',true,false,1,8,'A-1-1B-1-1',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-2-1',true,false,1,1,'A-1-1B-1-2',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-2-2',true,false,1,2,'A-1-1B-1-2',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-2-3',true,false,2,3,'A-1-1B-1-2',true);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-2-4',false,false,1,4,'A-1-1B-1-2',false);
INSERT BOX(BOX_ID, `_FULL`, `EMPTY`, `_SIZE`, SEQ, CELL_ID, OLD) VALUES('A-1-1B-1-2-5',false,true,1,5,'A-1-1B-1-2',false);



